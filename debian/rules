#!/usr/bin/make -f

export DH_VERBOSE = 1

%:
	dh $@

override_dh_auto_clean:
	# Skip clean - using pre-built binary
	true

override_dh_auto_configure:
	# Skip configure - using pre-built binary
	true

override_dh_auto_build:
	# Skip build - using pre-built binary
	true

override_dh_auto_test:
	# Skip tests
	true

override_dh_auto_install:
	# Create directories
	install -d $(CURDIR)/debian/process-exporter/etc/process-exporter
	install -d $(CURDIR)/debian/process-exporter/var/log/process-exporter

	# Install binary
	install -D -m 755 target/release/process-exporter \
		$(CURDIR)/debian/process-exporter/usr/bin/process-exporter

	# Install systemd service
	install -D -m 644 scripts/process-exporter.service \
		$(CURDIR)/debian/process-exporter/lib/systemd/system/process-exporter.service

	# Install environment configuration
	install -D -m 644 scripts/process-exporter.env \
		$(CURDIR)/debian/process-exporter/etc/process-exporter/process-exporter.env

	# Install dependency script
	install -D -m 755 scripts/install-deps.sh \
		$(CURDIR)/debian/process-exporter/usr/share/process-exporter/install-deps.sh

override_dh_installsystemd:
	dh_installsystemd --name=process-exporter --no-start

override_dh_strip:
	# Don't strip the binary (already stripped in release build)
	true